<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#fbcfe8">
    <title>„ÅäÈ¢®ÂëÇ„ÉÅ„Çß„ÉÉ„Ç´„Éº</title>
    
    <!-- SNS„Ç∑„Çß„Ç¢Áî®Ë®≠ÂÆö (OGP) -->
    <meta property="og:title" content="„ÅäÈ¢®ÂëÇ„ÉÅ„Çß„ÉÉ„Ç´„Éº">
    <meta property="og:description" content="ÁèæÂú®„ÅÆ„ÅäÈ¢®ÂëÇ„Å´ÂÖ•„Å£„Å¶„ÅÑ„Å™„ÅÑÊôÇÈñì„ÇíË®àÊ∏¨‰∏≠... „ÅÇ„Å™„Åü„ÅÆÊ∏ÖÊΩîÂ∫¶„ÅØÔºü">
    <meta property="og:type" content="website">
    <!-- ‚Üì„ÇÇ„ÅóÁîªÂÉè„ÅåÂá∫„Å™„ÅÑÂ†¥Âêà„ÅØ„ÄÅ„Åì„Åì„ÅÆ icon.png „Çí https://„ÅÇ„Å™„Åü„ÅÆID.github.io/„É™„Éù„Ç∏„Éà„É™Âêç/icon.png „Å´Êõ∏„ÅçÊèõ„Åà„Å¶„Åè„Å†„Åï„ÅÑ -->
    <meta property="og:image" content="icon.png">
    <meta name="twitter:card" content="summary">
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@500;700;900&display=swap" rel="stylesheet">

    <!-- „Ç¢„Ç§„Ç≥„É≥Ë®≠ÂÆö -->
    <link rel="apple-touch-icon" href="icon.png">
    <link rel="icon" href="icon.png">

    <style>
        body {
            font-family: 'Zen Maru Gothic', sans-serif;
            background-color: #ffe4e6;
            overscroll-behavior-y: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* „Çª„Éº„Éï„Ç®„É™„Ç¢ÂØæÂøú */
        .pb-safe { padding-bottom: env(safe-area-inset-bottom); }
        .pt-safe { padding-top: env(safe-area-inset-top); }

        .purupuru { animation: purupuru 2s infinite; }
        @keyframes purupuru {
            0% { transform: scale(1, 1); }
            10% { transform: scale(1.1, 0.9); }
            40% { transform: scale(0.9, 1.1); }
            50% { transform: scale(1, 1); }
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            border: 2px solid rgba(255, 255, 255, 0.9);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
        }

        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
        }
        
        .modal-enter { animation: modalPop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes modalPop {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- „Ç¢„Ç§„Ç≥„É≥„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà ---
        const Icon = ({ path, className, size = 24, onClick }) => (
            <svg onClick={onClick} xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {path}
            </svg>
        );

        const Icons = {
            Sparkles: (props) => <Icon {...props} path={<><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M9 5H5"/><path d="M5 19v2"/><path d="M9 19H5"/></>} />,
            Bath: (props) => <Icon {...props} path={<><path d="M9 6 6.5 3.5a1.5 1.5 0 0 0-1-1.5C3.81 2 2.5 3.31 2.5 5.5c0 1.56 1.15 2.1 1.8 2.2"/><path d="M21 10c0-1.66-1.34-3-3-3-1.12 0-2.1.58-2.6 1.5L14 10"/><path d="M7 10h14L19.5 21h-11Z"/><path d="M7 10v4"/></>} />,
            Clock: (props) => <Icon {...props} path={<><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></>} />,
            Share: (props) => <Icon {...props} path={<><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" x2="12" y1="2" y2="15"/></>} />,
            Calendar: (props) => <Icon {...props} path={<><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></>} />,
            X: (props) => <Icon {...props} path={<><path d="M18 6 6 18"/><path d="m6 6 12 12"/></>} />,
            ChevronLeft: (props) => <Icon {...props} path={<><path d="m15 18-6-6 6-6"/></>} />,
            ChevronRight: (props) => <Icon {...props} path={<><path d="m9 18 6-6-6-6"/></>} />
        };

        const BASE_RATE_PER_HOUR = 2.5; 

        const TIME_MESSAGES = [
            { hour: 0, msg: "„ÅäÈ¢®ÂëÇ‰∏ä„Åå„ÇäÊúÄÈ´ò„Äú‚ú® ‰ªä„Åå‰∏ÄÁï™ÂèØÊÑõ„ÅÑÔºÅ" },
            { hour: 3, msg: "„Åæ„Å†‰ΩôË£ïÔºÅ„Ç∑„É£„É≥„Éó„Éº„ÅÆ„ÅÑ„ÅÑÂåÇ„ÅÑ„Åô„Çã‚ô°" },
            { hour: 6, msg: "ÂâçÈ´™„Ç≠„Éº„Éó„Åß„Åç„Å¶„ÇãÔºü„Å°„Çá„Å£„Å®Á¢∫Ë™ç„Åó„Å¶„Åø„Å¶üëÄ" },
            { hour: 9, msg: "„Åù„Çç„Åù„ÇçÁöÆËÑÇ„ÅåÂá∫„Å¶„Åç„Åü„Åã„ÇÇ‚Ä¶„ÅÇ„Å∂„Çâ„Å®„ÇäÁ¥ô‰Ωø„ÅÜÔºü" },
            { hour: 12, msg: "„Å≠„Åà„ÄÅÈ†≠ÁöÆ„ÅÆÂåÇ„ÅÑÂ§ß‰∏àÂ§´„ÅùÔºüÊ≠£Áõ¥ÂøÉÈÖçüí¶" },
            { hour: 15, msg: "„Éô„Çø„Å§„ÅÑ„Å¶„Åç„Åü‚Ä¶„ÄÇ„Éâ„É©„Ç§„Ç∑„É£„É≥„Éó„Éº„Åó„Åü„ÅÑ„É¨„Éô„É´ü•∫" },
            { hour: 18, msg: "Ê≠£Áõ¥„ÄÅÈö£„Å´„ÅÑ„Çã„Å®„Ç≠„ÉÑ„Ç§„Åã„ÇÇüò± È¶ôÊ∞¥„ÅßË™§È≠îÂåñ„Åõ„Å™„ÅÑ„ÇàÔºÅ" },
            { hour: 21, msg: "„ÅäËÇå„ÅÆÊ∞¥ÂàÜÈáè„Çº„É≠ÔºÅÁ†ÇÊº†Áä∂ÊÖãüê´ ÂÖ•„Å£„Å¶„ÅäÈ°ò„ÅÑÔºÅ" },
            { hour: 24, msg: "ÈôêÁïåÁ™ÅÁ†¥„ÄÇ„Ç∑„É≥„Éó„É´„Å´Ê±ö„ÅÑ„Çàüò≠ Ë™∞„Å®„ÇÇ‰ºö„Çè„Å™„ÅÑ„ÅßÔºÅ" },
            { hour: 30, msg: "Ëèå„ÅÆÊ∏©Â∫ä„Å´„Å™„Å£„Å¶„Çã„Çàü¶† ‰ªä„Åô„Åê„ÅäÈ¢®ÂëÇË°å„Å£„Å¶ÔºÅ" }
        ];

        const EVENT_DAMAGES = {
            sleep: { label: "ÂØù„Å¶Ëµ∑„Åç„Åü", damage: 15, emoji: "üõå", msg: "Ëµ∑„Åç„Åü„ÇâÈ´™„Éú„Çµ„Éú„Çµ„Äúüí¶ ÂØùÊ±ó„Åã„ÅÑ„ÅüÔºÅ" },
            train: { label: "Ê∫ÄÂì°ÈõªËªä", damage: 15, emoji: "üöÉ", msg: "ÂØÜÁùÄ„ÇÑ„Å∞„Åô„Åé‚Ä¶Ëí∏„Çå„Å¶„ÇãÊ∞ó„Åå„Åô„Çãüíß" },
            outing: { label: "„Å°„Çá„Å£„Å®Â§ñÂá∫", damage: 10, emoji: "üëú", msg: "Â§ñ„ÅÆÁ©∫Ê∞óÊ±ö„Åô„Åé‚Ä¶„Éõ„Ç≥„É™„Å§„ÅÑ„Åü„Åã„ÇÇü§ß" },
            rain: { label: "Èõ®„ÉªÊπøÊ∞ó", damage: 10, emoji: "‚òî", msg: "ÊπøÊ∞ó„ÅßÈ´™ÁµÇ„Çè„Å£„Åü‚Ä¶„ÅÜ„Å≠„ÇäMAXüò≠" },
            exercise: { label: "‰ΩìËÇ≤„ÉªÈÅãÂãï", damage: 40, emoji: "üèÉ‚Äç‚ôÄÔ∏è", msg: "Ê±ó„ÇÑ„Å∞„ÅÑÔºÅ„Åì„Çå„ÅØÂç≥„Ç∑„É£„ÉØ„ÉºÊ°à‰ª∂üöø" },
            live: { label: "„É©„Ç§„Éñ„ÉªÊé®„ÅóÊ¥ª", damage: 35, emoji: "üé§", msg: "Ê±ó„Å†„Åè„ÅßÂÆåÂÖ®ÁáÉÁÑºüî• Ê•Ω„Åó„Åã„Å£„Åü„Åë„Å©‰Ωì„Éô„Çø„Éô„ÇøÔºÅ" },
            food: { label: "ÁÑºËÇâ/Êèö„ÅíÁâ©", damage: 20, emoji: "ü•©", msg: "ÂåÇ„ÅÑ„Å§„ÅÑ„Å°„ÇÉ„Å£„Åü‚Ä¶„Éï„Ç°„Éñ„É™„Éº„Ç∫„Åò„ÇÉÁÑ°ÁêÜüò≠" },
            ramen: { label: "„É©„Éº„É°„É≥", damage: 20, emoji: "üçú", msg: "„Éã„É≥„Éã„ÇØËÉåËÑÇ‚Ä¶ÁæéÂë≥„Åó„ÅÑ„Åë„Å©È´™„Å´ÂåÇ„ÅÑ„Ååüò±" },
            allnight: { label: "ÂæπÂ§ú„Éª„Ç™„Éº„É´", damage: 25, emoji: "üåô", msg: "ËÇåËçí„ÇåÁ¢∫ÂÆöÊºîÂá∫„ÄÇÂåñÁ≤ß„Éé„É™ÊúÄÊÇ™„Å´„Å™„Çä„Åù„ÅÜüíÄ" },
            mask: { label: "„Åö„Å£„Å®„Éû„Çπ„ÇØ", damage: 5, emoji: "üò∑", msg: "Âè£Âë®„Çä„ÅåËí∏„Çå„Å¶„Çã‚Ä¶ËÇåËçí„ÇåÊ≥®ÊÑèÂ†±üö®" }
        };

        const STORAGE_KEY_HP = 'hq_hp';
        const STORAGE_KEY_LAST_BATH = 'hq_last_bath';
        const STORAGE_KEY_DAMAGE = 'hq_damage';
        const STORAGE_KEY_LOGS = 'hq_logs';
        const STORAGE_KEY_HISTORY = 'hq_history';

        const CalendarModal = ({ isOpen, onClose, history }) => {
            const [currentDate, setCurrentDate] = useState(new Date());

            if (!isOpen) return null;

            const getDaysInMonth = (date) => {
                const year = date.getFullYear();
                const month = date.getMonth();
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const days = [];
                for (let i = 0; i < firstDay.getDay(); i++) {
                    days.push(null);
                }
                for (let i = 1; i <= lastDay.getDate(); i++) {
                    days.push(new Date(year, month, i));
                }
                return days;
            };

            const changeMonth = (delta) => {
                const newDate = new Date(currentDate);
                newDate.setMonth(newDate.getMonth() + delta);
                setCurrentDate(newDate);
            };

            const days = getDaysInMonth(currentDate);
            const monthLabel = `${currentDate.getFullYear()}Âπ¥ ${currentDate.getMonth() + 1}Êúà`;
            const historySet = new Set(history);

            return (
                <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4" onClick={onClose}>
                    <div className="bg-white rounded-3xl p-6 w-full max-w-sm modal-enter shadow-2xl relative" onClick={e => e.stopPropagation()}>
                        <button onClick={onClose} className="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                            <Icons.X />
                        </button>
                        
                        <h2 className="text-xl font-black text-pink-500 text-center mb-4 flex items-center justify-center gap-2">
                            <Icons.Calendar size={20}/> ÂÖ•Êµ¥„Çπ„Çø„É≥„ÉóÂ∏≥
                        </h2>

                        <div className="flex justify-between items-center mb-4 px-2">
                            <button onClick={() => changeMonth(-1)} className="p-2 hover:bg-gray-100 rounded-full"><Icons.ChevronLeft size={20}/></button>
                            <span className="font-bold text-gray-700">{monthLabel}</span>
                            <button onClick={() => changeMonth(1)} className="p-2 hover:bg-gray-100 rounded-full"><Icons.ChevronRight size={20}/></button>
                        </div>

                        <div className="calendar-grid mb-2 text-center text-xs font-bold text-gray-400">
                            <div className="text-red-400">Êó•</div><div>Êúà</div><div>ÁÅ´</div><div>Ê∞¥</div><div>Êú®</div><div>Èáë</div><div className="text-blue-400">Âúü</div>
                        </div>

                        <div className="calendar-grid gap-y-3">
                            {days.map((date, i) => {
                                if (!date) return <div key={i}></div>;
                                const dateStr = date.toISOString().split('T')[0];
                                const isClean = historySet.has(dateStr);
                                const isToday = date.toDateString() === new Date().toDateString();

                                return (
                                    <div key={i} className="flex flex-col items-center justify-start h-10">
                                        <span className={`text-xs mb-1 ${isToday ? 'bg-pink-500 text-white w-5 h-5 rounded-full flex items-center justify-center' : 'text-gray-600'}`}>
                                            {date.getDate()}
                                        </span>
                                        {isClean && (
                                            <span className="text-lg leading-none animate-bounce">üíÆ</span>
                                        )}
                                    </div>
                                );
                            })}
                        </div>
                        
                        <p className="text-xs text-center text-gray-400 mt-6">
                            „ÅäÈ¢®ÂëÇ„Å´ÂÖ•„Çã„Å®„Çπ„Çø„É≥„Éó„ÅåÊäº„Åï„Çå„Çã„ÇàÔºÅ<br/>ÊØéÊó•Âüã„ÇÅ„Å¶ÁæéÊÑèË≠òÈ´ò„ÇÅ„Çà„ÅÜ‚ú®
                        </p>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [hp, setHp] = useState(100);
            const [lastBathTime, setLastBathTime] = useState(new Date());
            const [eventDamageTotal, setEventDamageTotal] = useState(0);
            const [logs, setLogs] = useState([]);
            const [currentTime, setCurrentTime] = useState(new Date());
            const [currentMsg, setCurrentMsg] = useState("");
            const [quickAction, setQuickAction] = useState(null);
            const [lastAppliedTimeMsg, setLastAppliedTimeMsg] = useState("");
            const [lastActionTime, setLastActionTime] = useState(new Date(0));
            const [bathHistory, setBathHistory] = useState([]);
            const [isCalendarOpen, setIsCalendarOpen] = useState(false);

            useEffect(() => {
                const loadData = () => {
                    try {
                        const savedHp = localStorage.getItem(STORAGE_KEY_HP);
                        const savedLastBath = localStorage.getItem(STORAGE_KEY_LAST_BATH);
                        const savedDamage = localStorage.getItem(STORAGE_KEY_DAMAGE);
                        const savedLogs = localStorage.getItem(STORAGE_KEY_LOGS);
                        const savedHistory = localStorage.getItem(STORAGE_KEY_HISTORY);

                        if (savedHp) setHp(parseFloat(savedHp));
                        if (savedLastBath) setLastBathTime(new Date(savedLastBath));
                        if (savedDamage) setEventDamageTotal(parseFloat(savedDamage));
                        if (savedLogs) setLogs(JSON.parse(savedLogs));
                        if (savedHistory) setBathHistory(JSON.parse(savedHistory));
                    } catch (e) {
                        console.error("Failed to load data", e);
                    }
                };
                loadData();
                
                const params = new URLSearchParams(window.location.search);
                const action = params.get('action');
                if (action) {
                    if (action === 'bath') {
                        setTimeout(() => setQuickAction({ type: 'bath' }), 500);
                    } else if (EVENT_DAMAGES[action]) {
                        setTimeout(() => setQuickAction({ type: 'event', key: action }), 500);
                    }
                    window.history.replaceState({}, document.title, window.location.pathname);
                }
            }, []);

            useEffect(() => {
                localStorage.setItem(STORAGE_KEY_HP, hp.toString());
                localStorage.setItem(STORAGE_KEY_LAST_BATH, lastBathTime.toISOString());
                localStorage.setItem(STORAGE_KEY_DAMAGE, eventDamageTotal.toString());
                localStorage.setItem(STORAGE_KEY_LOGS, JSON.stringify(logs));
                localStorage.setItem(STORAGE_KEY_HISTORY, JSON.stringify(bathHistory));
            }, [hp, lastBathTime, eventDamageTotal, logs, bathHistory]);

            useEffect(() => {
                const timer = setInterval(() => {
                    setCurrentTime(new Date());
                }, 1000);
                return () => clearInterval(timer);
            }, []);

            useEffect(() => {
                const diffMs = new Date() - lastBathTime;
                const hoursElapsed = (diffMs / (1000 * 60 * 60));
                const baseDamage = hoursElapsed * BASE_RATE_PER_HOUR;
                const totalDamage = baseDamage + eventDamageTotal;
                let currentHp = 100 - totalDamage;
                currentHp = Math.max(0, Math.min(100, currentHp));
                setHp(currentHp);

                if (new Date() - lastActionTime < 8000) return;

                const roundedHour = Math.floor(hoursElapsed);
                const msgObj = TIME_MESSAGES.slice().reverse().find(m => roundedHour >= m.hour);

                if (msgObj && msgObj.msg !== lastAppliedTimeMsg) {
                    setCurrentMsg(msgObj.msg);
                    setLastAppliedTimeMsg(msgObj.msg);
                }
            }, [currentTime, lastBathTime, eventDamageTotal, lastAppliedTimeMsg, lastActionTime]);
            
            useEffect(() => {
                if (quickAction) {
                    if (quickAction.type === 'bath') handleBath();
                    else if (quickAction.type === 'event') handleEvent(quickAction.key);
                    setQuickAction(null);
                }
            }, [quickAction]);

            const handleEvent = (eventKey) => {
                const event = EVENT_DAMAGES[eventKey];
                setEventDamageTotal(prev => prev + event.damage);
                addLog(event.msg, event.emoji);
                setCurrentMsg(event.msg);
                setLastActionTime(new Date());
                if (navigator.vibrate) navigator.vibrate(50);
            };

            const handleBath = () => {
                setLastBathTime(new Date());
                setEventDamageTotal(0);
                setHp(100);
                addLog("„ÅäÈ¢®ÂëÇÂÖ•„Å£„Å¶Âæ©Ê¥ªÔºÅ‰ªäÊó•„ÇÇÁßÅ„Åå‰∏ÄÁï™„Ç´„ÉØ„Ç§„Ç§üíñ", "üõÅ");
                setCurrentMsg("„ÅäÈ¢®ÂëÇ‰∏ä„Åå„ÇäÊúÄÈ´ò„Äú‚ú® ‰ªä„Åå‰∏ÄÁï™ÂèØÊÑõ„ÅÑÔºÅ");
                setLastAppliedTimeMsg("„ÅäÈ¢®ÂëÇ‰∏ä„Åå„ÇäÊúÄÈ´ò„Äú‚ú® ‰ªä„Åå‰∏ÄÁï™ÂèØÊÑõ„ÅÑÔºÅ");
                setLastActionTime(new Date());
                
                const today = new Date().toISOString().split('T')[0];
                setBathHistory(prev => {
                    const newHistory = new Set(prev);
                    newHistory.add(today);
                    return Array.from(newHistory);
                });

                if (navigator.vibrate) navigator.vibrate([0, 100, 50, 100]);
            };

            const getStatusDesign = (currentHp) => {
                if (currentHp >= 80) return { 
                    avatar: "üë∏", label: "ÂÑ™Âãù", 
                    textColor: 'text-pink-600', bgColor: 'bg-pink-50',
                    barColor: 'bg-gradient-to-r from-pink-300 to-pink-500',
                    shareMsg: "‰ªä„Åå‰∏ÄÁï™ÂèØÊÑõ„ÅÑÔºÅÂÖ®‰∫∫È°ûË¶ã„Å¶‚ú® È¶ô„Çä„Åæ„ÅßÂÆåÁíß‚ô°"
                };
                if (currentHp >= 50) return { 
                    avatar: "üòê", label: "„Éì„Éü„Éß„Éº", 
                    textColor: 'text-yellow-600', bgColor: 'bg-yellow-50',
                    barColor: 'bg-gradient-to-r from-yellow-300 to-yellow-500',
                    shareMsg: "„Åæ„Å†Ëàû„Åà„Çã‚Ä¶„ÅØ„Åö„ÄÇË™∞„Åã„ÅäÈ¢®ÂëÇÂÖ•„Çå„Å¶ü•∫"
                };
                if (currentHp >= 20) return { 
                    avatar: "üò∞", label: "Ëêé„Åà", 
                    textColor: 'text-orange-600', bgColor: 'bg-orange-50',
                    barColor: 'bg-gradient-to-r from-orange-300 to-orange-500',
                    shareMsg: "Ê∏ÖÊΩîÊÑüË°åÊñπ‰∏çÊòé„ÄÇÂçäÂæÑ2m‰ª•ÂÜÖÁ´ã„Å°ÂÖ•„ÇäÁ¶ÅÊ≠¢‚ö†Ô∏è"
                };
                return { 
                    avatar: "üßü‚Äç‚ôÄÔ∏è", label: "ÁµÇ‰∫Ü", 
                    textColor: 'text-purple-600', bgColor: 'bg-purple-50',
                    barColor: 'bg-gradient-to-r from-gray-700 to-purple-800',
                    shareMsg: "Á§æ‰ºöÁöÑ„Å´Ê≠ª„Å´„Åæ„Åó„Åüüòá ËòáÁîü(ÂÖ•Êµ¥)Ê±Ç„ÇÄ‚Ä¶"
                };
            };

            // „Ç∑„Çß„Ç¢Ê©üËÉΩ
            const handleShare = async () => {
                const hoursSinceBath = ((new Date() - lastBathTime) / (1000 * 60 * 60)).toFixed(1);
                const status = getStatusDesign(hp);
                const shareUrl = window.location.href;
                
                // „Åì„Åì„Åß„Ç∑„Çß„Ç¢ÊñáË®Ä„ÇíÁîüÊàê„Åó„Å¶„ÅÑ„Åæ„Åô
                const text = `„Äê„ÅäÈ¢®ÂëÇ„ÉÅ„Çß„ÉÉ„Ç´„Éº„Äë\nÁèæÂú®„ÄÅ„ÅäÈ¢®ÂëÇ„Å´ÂÖ•„Çâ„Åö${hoursSinceBath}ÊôÇÈñìÁµåÈÅé‚Ä¶\nÁõõ„ÇåÂ∫¶${Math.floor(hp)}% (${status.label})\n\n„Äå${status.shareMsg}„Äç\n\n#„ÅäÈ¢®ÂëÇ„ÉÅ„Çß„ÉÉ„Ç´„Éº\n${shareUrl}`;

                if (navigator.share) {
                    try {
                        await navigator.share({
                            title: '„ÅäÈ¢®ÂëÇ„ÉÅ„Çß„ÉÉ„Ç´„Éº',
                            text: text,
                        });
                        return;
                    } catch (err) {
                        if (err.name === 'AbortError') return;
                    }
                }

                try {
                    await navigator.clipboard.writeText(text);
                    alert('ÊñáÁ´†„Çí„Ç≥„Éî„Éº„Åó„Åæ„Åó„ÅüÔºÅSNS„Å´Ë≤º„Çä‰ªò„Åë„Å¶„Å≠üìã\n\n' + text);
                } catch (err) {
                    const isYes = confirm('ÊñáÁ´†„ÅÆ„Ç≥„Éî„Éº„Å´Â§±Êïó„Åó„Åæ„Åó„Åüüí¶\n‰ª£„Çè„Çä„Å´Twitter(X)„ÅÆÊäïÁ®øÁîªÈù¢„ÇíÈñã„Åç„Åæ„Åô„ÅãÔºü');
                    if (isYes) {
                        window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`, '_blank');
                    }
                }
            };

            const addLog = (text, icon) => {
                const now = new Date();
                const timeStr = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
                setLogs(prev => {
                    const newLogs = [{ time: timeStr, text: text, icon: icon || "üì±" }, ...prev];
                    return newLogs.slice(0, 50);
                });
            };

            const status = getStatusDesign(hp);
            const hoursSinceBath = ((new Date() - lastBathTime) / (1000 * 60 * 60)).toFixed(1);

            return (
                <div className={`min-h-screen w-full flex flex-col items-center py-6 px-4 ${status.bgColor} transition-colors duration-500 font-sans pb-safe relative`}>
                    
                    {/* Header (Flex Layout) */}
                    <div className="w-full flex justify-between items-center pt-safe mb-6 mt-2 relative z-20">
                        {/* „Ç´„É¨„É≥„ÉÄ„Éº„Éú„Çø„É≥ */}
                        <button onClick={() => setIsCalendarOpen(true)} className="bg-white/80 p-3 rounded-full shadow-md text-pink-500 hover:scale-110 transition-transform">
                            <Icons.Calendar size={24} />
                        </button>

                        {/* „Çø„Ç§„Éà„É´ */}
                        <div className="inline-block bg-white px-4 py-2 rounded-full border-2 border-pink-200 shadow-sm mx-2">
                            <h1 className="text-lg font-black text-pink-500 tracking-wider flex items-center gap-2 justify-center whitespace-nowrap">
                                <Icons.Sparkles size={18} /> „ÅäÈ¢®ÂëÇ„ÉÅ„Çß„ÉÉ„Ç´„Éº <Icons.Sparkles size={18} />
                            </h1>
                        </div>

                        {/* „Ç∑„Çß„Ç¢„Éú„Çø„É≥ */}
                        <button onClick={handleShare} className="bg-white/80 p-3 rounded-full shadow-md text-blue-500 hover:scale-110 transition-transform">
                            <Icons.Share size={24} />
                        </button>
                    </div>

                    <div className="w-full max-w-sm glass-card rounded-3xl p-6 mb-6 text-center relative overflow-hidden transition-all duration-300">
                        <div className="absolute top-4 right-4 rotate-12 bg-white px-3 py-1 rounded-lg border-2 border-gray-800 font-bold shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] z-10">
                            {status.label}
                        </div>
                        <div className="text-8xl mb-4 mt-4 purupuru filter drop-shadow-xl select-none">
                            {status.avatar}
                        </div>
                        <div className="relative pt-1 mb-2">
                            <div className="flex mb-2 items-center justify-between">
                                <span className="text-xs font-bold inline-block py-1 px-2 uppercase rounded-full text-pink-600 bg-pink-100">Áõõ„ÇåÂ∫¶</span>
                                <span className="text-xs font-bold inline-block text-pink-600">{Math.floor(hp)}%</span>
                            </div>
                            <div className="overflow-hidden h-4 mb-4 text-xs flex rounded-full bg-white border-2 border-pink-100">
                                <div style={{ width: `${hp}%` }} className={`shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center transition-all duration-500 ${status.barColor}`}></div>
                            </div>
                        </div>
                        <div className="relative bg-white rounded-xl p-4 border-2 border-gray-100 shadow-sm mt-2">
                            <div className="absolute -top-3 left-1/2 transform -translate-x-1/2 w-4 h-4 bg-white border-t-2 border-l-2 border-gray-100 rotate-45"></div>
                            <p className="font-bold text-gray-700 leading-relaxed text-sm">
                                {currentMsg || "Ë®àÁÆó‰∏≠..."}
                            </p>
                        </div>
                    </div>

                    <div className="bg-white/60 px-5 py-2 rounded-full mb-6 text-sm font-bold text-gray-600 border border-white flex items-center gap-2">
                        <Icons.Clock size={16} className="text-pink-400" /> 
                        „ÅäÈ¢®ÂëÇ„Åã„Çâ <span className="text-xl text-pink-500 font-black">{hoursSinceBath}</span> ÊôÇÈñìÁµåÈÅé
                    </div>

                    <div className="w-full max-w-sm mb-6">
                        <div className="text-xs font-bold text-gray-400 mb-2 pl-2">‚ñº ‰Ωï„Åã„ÅÇ„Å£„ÅüÔºü („Çø„ÉÉ„Éó„ÅßËøΩÂä†)</div>
                        <div className="grid grid-cols-2 gap-3">
                            {Object.keys(EVENT_DAMAGES).map(key => (
                                <button key={key} onClick={() => handleEvent(key)} className="bg-white hover:bg-pink-50 border-2 border-pink-100 text-gray-700 py-3 px-3 rounded-2xl shadow-sm active:scale-95 transition-transform flex items-center gap-3 text-left w-full">
                                    <span className="text-2xl min-w-[30px] text-center select-none">{EVENT_DAMAGES[key].emoji}</span>
                                    <span className="text-xs font-bold leading-tight flex-1">{EVENT_DAMAGES[key].label}</span>
                                </button>
                            ))}
                        </div>
                    </div>

                    <button onClick={handleBath} className="w-full max-w-sm bg-gradient-to-r from-pink-400 to-purple-400 hover:from-pink-500 hover:to-purple-500 text-white font-black py-4 rounded-full shadow-lg border-4 border-white active:scale-95 transition-all mb-8 flex items-center justify-center gap-2 text-lg">
                        <Icons.Bath size={24} />
                        <span>„ÅäÈ¢®ÂëÇÂÖ•„Å£„Å¶„É™„Çª„ÉÉ„Éà‚ú®</span>
                    </button>

                    <div className="w-full max-w-sm bg-white/50 rounded-2xl p-4 h-48 overflow-y-auto border border-white scrollbar-hide">
                        <h3 className="text-xs font-bold text-gray-400 mb-3 pl-1 sticky top-0 bg-transparent">HISTORY</h3>
                        <div className="space-y-3">
                            {logs.map((log, index) => (
                                <div key={index} className="flex gap-3 animate-fade-in-up">
                                    <div className="w-8 h-8 rounded-full bg-pink-100 flex items-center justify-center flex-shrink-0 text-lg border border-pink-200 select-none">{log.icon}</div>
                                    <div className="bg-white p-2 rounded-r-xl rounded-bl-xl text-xs shadow-sm border border-gray-100 flex-1">
                                        <div className="text-gray-400 text-[10px] mb-0.5">{log.time}</div>
                                        {log.text}
                                    </div>
                                </div>
                            ))}
                            {logs.length === 0 && <p className="text-xs text-gray-400 text-center py-4">„Åæ„Å†Â±•Ê≠¥„ÅØ„Å™„ÅÑ„ÇàÔºÅ</p>}
                        </div>
                    </div>

                    <CalendarModal 
                        isOpen={isCalendarOpen} 
                        onClose={() => setIsCalendarOpen(false)} 
                        history={bathHistory}
                    />
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>